<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>NASA Image & Video Library</title>
  <link rel="stylesheet" href="css/galactic.css">
  <link rel="stylesheet" href="css/library-controls.css">
</head>

<body class="page library">
  <div class="space-ambient">
    <div class="stars"></div>
    <div class="media-bg"></div>
    <div class="glow-orbit"></div>
  </div>
  <header class="mast">
    <div class="logo">NASA Explorer</div>
    <nav class="space-nav">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="apod.html">APOD</a></li>
        <li><a href="mars.html">Mars</a></li>
        <!-- <li><a href="epic.html">EPIC</a></li> -->
        <li><a href="neows.html">NeoWs</a></li>
        <li><a href="donki.html">DONKI</a></li>
        <li><a href="eonet.html">EONET</a></li>
        <li><a href="library.html" class="active">Library</a></li>
        <li><a href="tech.html">Tech</a></li>
        <!-- <li><a href="exoplanets.html">Exoplanets</a></li> -->
      </ul>
    </nav>
  </header>

  <main class="content">
    <section class="panel">
      <h2>NASA Image & Video Library</h2>
      <p class="desc">Search NASA's images and videos by keyword.</p>

      <div class="search-row">
        <input type="text" id="search-input" placeholder="Search NASA media..." aria-label="search" />
        <button id="search-btn">Search</button>
      </div>

      <div class="masonry" id="results-grid">
        <!-- Dynamic search results will appear here -->
      </div>
    </section>
  </main>
  <footer class="foot">NASA Image Library â€¢ UI Prototype</footer>

  <script>
    const searchBtn = document.getElementById('search-btn');
    const searchInput = document.getElementById('search-input');
    const resultsGrid = document.getElementById('results-grid');

    async function searchNASA(query) {
      resultsGrid.innerHTML = '<p style="text-align:center;">Loading...</p>';
      try {
        const response = await fetch(`https://images-api.nasa.gov/search?q=${encodeURIComponent(query)}`);
        if (!response.ok) throw new Error('Network response was not ok');

        const data = await response.json();
        const items = data.collection.items;

        if (!items.length) {
          resultsGrid.innerHTML = '<p style="text-align:center;">No results found.</p>';
          return;
        }

        // Render results
        resultsGrid.innerHTML = items.map(item => {
          const title = item.data[0].title;
          const description = item.data[0].description || '';
          const thumb = item.links ? item.links[0].href : '';
          return `
            <figure class="m-item">
              <img src="${thumb}" alt="${title}">
              <figcaption>
                <h4>${title}</h4>
                <p>${description.substring(0, 100)}...</p>
              </figcaption>
            </figure>
          `;
        }).join('');

      } catch (err) {
        resultsGrid.innerHTML = `<p style="text-align:center;">Error loading data: ${err.message}</p>`;
      }
    }

    searchBtn.addEventListener('click', () => {
      const query = searchInput.value.trim();
      if (query) searchNASA(query);
    });

    searchInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        const query = searchInput.value.trim();
        if (query) searchNASA(query);
      }
    });
  </script>
</body>

</html>